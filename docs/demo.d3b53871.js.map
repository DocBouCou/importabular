{"version":3,"sources":["../src/index.js","demo.js","../node_modules/parcel-bundler/src/builtins/bundle-url.js","../node_modules/parcel-bundler/src/builtins/css-loader.js"],"names":["Importabular","x","y","options","maxWidth","maxHeight","data","node","LooseArray","onChange","onSelectionChange","contentStyle","cellStyle","minHeight","Infinity","minWidth","fillScrollPaneWithCells","separatorColor","border","background","width","height","padding","margin","e","editing","preventDefault","rows","parsePasteEvent","selection","rx","ry","offset","forEach","row","val","setVal","changeSelectedCellsStyle","selectionStart","selectionEnd","length","onDataChanged","asArr","getSelectionAsArray","clipboardData","setData","arrToHTML","map","join","copy","setAllSelectedCellsTo","ctrlKey","key","revertEdit","stopEditing","moveCursor","shiftKey","startEditing","getCell","firstChild","value","mobile","tbody","style","userSelect","getCoords","selecting","endSelection","lastMouseUp","Date","now","lastMouseUpTarget","target","moved","td","input","removeEventListener","blurIfEnter","removeChild","renderTDContent","code","keyCode","status","getStatus","cell","Object","assign","TDStyle","div","tagName","innerText","getVal","restyle","parent","setupDom","replaceDataWithArray","incrementToFit","fillScrollSpace","Math","ceil","iframe","contentWindow","innerHeight","cols","innerWidth","toArr","clear","refreshDisplayedValue","document","createElement","setAttribute","toString","innerHTML","appendChild","cwd","open","write","close","iframeStyle","body","iframeBodyStyle","table","borderSpacing","fontSize","fontFamily","borderCollapse","tr","addCell","events","name","addEventListener","destroyEditing","parentElement","fitBounds","Array","prototype","call","children","incrementWidth","incrementHeight","result","push","forSelectionCoord","shiftSelectionEnd","curr","nc","srollIntoView","scrollIntoView","behavior","block","tdSize","getBoundingClientRect","cellSize","type","focus","callback","oldS","getSelectionCoords","reverse","cb","selected","onlySelected","editTarget","borderStyle","borderWidth","borderColor","boxSizing","cleanStyle","arguments","font","lineHeight","color","getAttribute","parseInt","line","selectedCount","hash","cleanedVal","cleanVal","isEmpty","max","obj","keys","arr","outerHTML","event","html","window","getData","trs","querySelectorAll","tds","text","ensureDimensions","fromText","split","s","getElementById","bundleURL","getBundleURLCached","getBundleURL","Error","err","matches","stack","match","getBaseURL","url","replace","exports","bundle","require","updateLink","link","newLink","cloneNode","onload","remove","href","parentNode","insertBefore","nextSibling","cssTimeout","reloadCSS","setTimeout","links","i","module"],"mappings":"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","file":"demo.d3b53871.js","sourceRoot":"../demo","sourcesContent":["export default class Importabular {\n  parent = null\n  width = 1\n  height = 1\n  data = new LooseArray()\n  options = {\n    onChange: null,\n    onSelectionChange: null,\n    contentStyle: () => null,\n    cellStyle: () => null,\n    minHeight: 1,\n    maxHeight: Infinity,\n    minWidth: 1,\n    maxWidth: Infinity,\n    fillScrollPaneWithCells:true,\n    separatorColor:'#ddd',\n  }\n\n  fitBounds({x, y}) {\n    return x >= 0 && x < this.options.maxWidth\n      && y >= 0 && y < this.options.maxHeight\n  }\n\n  constructor({data = [], node, ...options}) {\n    this.parent = node\n    Object.assign(this.options, options)\n    this.setupDom()\n    this.replaceDataWithArray(data)\n    this.incrementToFit({x: this.options.minWidth - 1, y: this.options.minHeight - 1})\n    this.fillScrollSpace()\n  }\n  fillScrollSpace(){\n    if(!this.options.fillScrollPaneWithCells) return\n    const rows=Math.ceil(this.iframe.contentWindow.innerHeight/40)\n    const cols=Math.ceil(this.iframe.contentWindow.innerWidth/100)\n    this.incrementToFit({x: cols - 1, y: rows - 1})\n  }\n\n  onDataChanged() {\n    if (this.options.onChange) {\n      this.options.onChange(this.data.toArr())\n    }\n  }\n\n  setData(data) {\n    this.data.clear()\n    data.forEach((row, y) =>\n      row.forEach((val, x) =>\n        this.setVal(x, y, val)\n      ))\n    for (let x = 0; x < this.width; x++)\n      for (let y = 0; y < this.height; y++)\n        this.refreshDisplayedValue({x, y})\n\n  }\n\n  renderTDContent(td, x, y) {\n    const div = document.createElement('div')\n    td.setAttribute('x', x.toString())\n    td.setAttribute('y', y.toString())\n    const val = this.getVal(x, y)\n    if (val) {\n      div.innerText = val;\n    } else {\n      // Force no collapse of cell\n      div.innerHTML = '&nbsp;'\n    }\n    td.appendChild(div)\n    this.restyle({x, y})\n\n  }\n\n  iframeStyle = {\n    border: 'none',\n    background: 'transparent',\n    width: '100%',\n    height: '500px'\n  }\n  iframeBodyStyle = {\n    padding: 0, margin: 0\n  }\n\n  setupDom() {\n    // We wrap the table in an iframe mostly to let the browser\n    // handle the focus for us, without the need for a hidden\n    // input. It also makes sure that the style of the table is \"clean\"\n    // but makes it harder to style the content.\n    const iframe = document.createElement('iframe');\n    this.iframe = iframe\n    this.parent.appendChild(iframe)\n    const cwd = iframe.contentWindow.document\n    this.cwd = cwd\n    cwd.open();\n    cwd.write(`<html><body><style>\n    html{\n      -ms-overflow-style: none;\n      scrollbar-width: none;\n    }\n    ::-webkit-scrollbar {\n        visibility: hidden;\n    }\n    </style></body></html>`);\n    cwd.close();\n    Object.assign(iframe.style, this.iframeStyle)\n    Object.assign(cwd.body.style, this.iframeBodyStyle)\n\n    const table = document.createElement('table')\n    const tbody = document.createElement('tbody')\n    Object.assign(table.style, {\n      borderSpacing: 0,\n      background: 'white',\n      border: '1px solid'+this.options.separatorColor,\n      fontSize: '16px',\n      fontFamily: 'sans-serif',\n      borderCollapse: 'separate',\n    })\n\n\n    table.appendChild(tbody)\n    cwd.body.appendChild(table)\n    this.tbody = tbody\n    this.table = table\n\n    for (let y = 0; y < this.height; y++) {\n      const tr = document.createElement('tr')\n      tbody.appendChild(tr)\n      for (let x = 0; x < this.width; x++) {\n        this.addCell(tr, x, y)\n      }\n    }\n\n    this.events.forEach(name =>\n      cwd.addEventListener(name, this[name], true)\n    )\n  }\n\n  events = ['mousedown', 'mouseenter', 'mouseup', 'mouseleave', 'touchstart',\n    'touchend', 'touchmove', 'keydown', 'paste', 'cut', 'copy'\n  ]\n\n  destroy() {\n    this.destroyEditing()\n\n    this.events.forEach(name =>\n      this.cwd.removeEventListener(name, this[name], true)\n    )\n\n    this.iframe.parentElement.removeChild(this.iframe)\n  }\n\n\n  addCell(tr, x, y) {\n    const td = document.createElement('td')\n    tr.appendChild(td)\n    this.renderTDContent(td, x, y)\n  }\n\n  incrementHeight() {\n\n    if (!this.fitBounds({x:0,y:this.height})) return false\n    this.height++\n    const y = this.height - 1\n    const tr = document.createElement('tr')\n\n    this.tbody.appendChild(tr)\n    for (let x = 0; x < this.width; x++) {\n      this.addCell(tr, x, y)\n    }\n    return true\n  }\n\n  incrementWidth() {\n\n    if (!this.fitBounds({x:this.width, y:0})) return false\n    this.width++\n    const x = this.width - 1\n    Array.prototype.forEach.call(this.tbody.children, (tr, y) => {\n      this.addCell(tr, x, y)\n    })\n    return true\n  }\n\n  incrementToFit({x, y}) {\n    while (x > this.width - 1 && this.incrementWidth());\n    while (y > this.height - 1 && this.incrementHeight());\n  }\n\n  paste = e => {\n    if (this.editing) return\n    e.preventDefault();\n    const rows = parsePasteEvent(e)\n    const {rx, ry} = this.selection\n    const offset = {x: rx[0], y: ry[0]}\n\n    rows.forEach((row, y) => {\n      row.forEach((val, x) => {\n        this.setVal(offset.x + x, offset.y + y, val)\n      })\n    })\n\n    this.changeSelectedCellsStyle(() => {\n      this.selectionStart = offset\n      this.selectionEnd = {\n        x: offset.x + rows[0].length - 1,\n        y: offset.y + rows.length - 1\n      }\n    })\n    this.onDataChanged()\n  }\n\n  getSelectionAsArray() {\n    const {rx, ry} = this.selection\n    if (rx[0] === rx[1]) return null\n    const width = rx[1] - rx[0]\n    const height = ry[1] - ry[0]\n    const result = []\n    for (let y = 0; y < height; y++) {\n      result.push([])\n      for (let x = 0; x < width; x++) {\n        result[y].push(this.getVal(rx[0] + x, ry[0] + y))\n      }\n    }\n    return result\n  }\n\n  copy = e => {\n    const asArr = this.getSelectionAsArray()\n    if (asArr) {\n      e.preventDefault()\n      e.clipboardData.setData('text/html', arrToHTML(asArr));\n      e.clipboardData.setData('text/plain', asArr.map(row => row.join('\\t')).join('\\n'));\n    }\n  }\n\n  cut = e => {\n    this.copy(e)\n    this.setAllSelectedCellsTo('')\n  }\n\n  keydown = e => {\n\n    if (e.ctrlKey) return\n\n    if (this.selectionStart) {\n      if (e.key === 'Escape' && this.editing) {\n        e.preventDefault()\n        this.revertEdit()\n        this.stopEditing()\n      }\n      if (e.key === 'Enter') {\n        e.preventDefault()\n        this.moveCursor({y: 1})\n      }\n\n      if (e.key === 'Tab') {\n        e.preventDefault()\n        this.moveCursor({x: e.shiftKey ? -1 : 1})\n      }\n      if (!this.editing) {\n\n        if (e.key === 'Delete' || e.key === 'Backspace') {\n          e.preventDefault()\n          this.setAllSelectedCellsTo('')\n        }\n        if (e.key === 'ArrowDown') {\n          e.preventDefault()\n          this.moveCursor({y: 1}, e.shiftKey)\n        }\n\n        if (e.key === 'ArrowUp') {\n          e.preventDefault()\n          this.moveCursor({y: -1}, e.shiftKey)\n        }\n        if (e.key === 'ArrowLeft') {\n          e.preventDefault()\n          this.moveCursor({x: -1}, e.shiftKey)\n        }\n        if (e.key === 'ArrowRight') {\n          e.preventDefault()\n          this.moveCursor({x: +1}, e.shiftKey)\n        }\n      }\n\n\n      if (e.key.length === 1 && !this.editing) {\n        this.changeSelectedCellsStyle(() => {\n          const {x, y} = this.selectionStart\n          // We clear the value of the cell, and the keyup event will\n          // happen with the cursor inside the cell and type the character there\n          this.startEditing({x, y})\n          this.getCell(x, y).firstChild.value = ''\n        })\n      }\n    }\n  }\n\n  setAllSelectedCellsTo(value) {\n    this.forSelectionCoord(this.selection, ({x, y}) => this.setVal(x, y, value))\n    this.forSelectionCoord(this.selection, this.refreshDisplayedValue)\n\n    this.onDataChanged()\n  }\n\n  moveCursor({x = 0, y = 0}, shiftSelectionEnd) {\n    const curr = shiftSelectionEnd ? this.selectionEnd : this.selectionStart\n    const nc = {x: curr.x + x, y: curr.y + y}\n    if (!this.fitBounds(nc)) return\n    this.stopEditing()\n    this.incrementToFit(nc)\n    this.changeSelectedCellsStyle(() => {\n      if (shiftSelectionEnd) {\n        this.selectionEnd = nc\n      } else {\n        this.selectionStart = this.selectionEnd = nc\n      }\n    })\n    this.srollIntoView(nc)\n  }\n  srollIntoView({x,y}){\n    this.getCell(x, y).scrollIntoView({behavior:'smooth', block:'nearest'})\n  }\n\n  selecting = false;\n  selectionStart = null\n  selectionEnd = null\n  selection = {rx: [0, 0], ry: [0, 0]}\n  editing = null\n\n  mousedown = e => {\n\n    if (this.mobile) return\n    this.changeSelectedCellsStyle(() => {\n      this.tbody.style.userSelect = 'none'\n      this.selectionStart = this.getCoords(e);\n      this.selectionEnd = this.selectionStart\n      this.selecting = true;\n    })\n  }\n  mouseenter = e => {\n    if (this.mobile) return\n    if (this.selecting) {\n      this.changeSelectedCellsStyle(() => {\n        this.selectionEnd = this.getCoords(e);\n      })\n    }\n  }\n\n  lastMouseUp = null\n  lastMouseUpTarget = null\n\n  endSelection() {\n    this.selecting = false;\n    this.tbody.style.userSelect = ''\n  }\n\n  mouseup = e => {\n\n    if (this.mobile) return\n    if (this.selecting) {\n      this.changeSelectedCellsStyle(() => {\n        this.selectionEnd = this.getCoords(e);\n        this.endSelection()\n\n        if (this.lastMouseUp &&\n          this.lastMouseUp > Date.now() - 300 &&\n          this.lastMouseUpTarget.x === this.selectionEnd.x &&\n          this.lastMouseUpTarget.y === this.selectionEnd.y\n        ) {\n          this.startEditing(this.selectionEnd)\n        }\n        this.lastMouseUp = Date.now()\n        this.lastMouseUpTarget = this.selectionEnd\n      })\n    }\n  }\n  mouseleave = e => {\n    if(e.target===this.tbody && this.selecting) {\n      this.endSelection()\n    }\n  }\n\n  touchstart = e => {\n    if (this.editing) return\n    this.mobile = true\n    this.moved = false\n  }\n  touchend = e => {\n    if (!this.mobile) return\n    if (this.editing) return\n    if (!this.moved) {\n\n      this.changeSelectedCellsStyle(() => {\n        this.selectionEnd = this.selectionStart = this.getCoords(e);\n      })\n      this.startEditing(this.selectionEnd)\n    }\n  }\n  touchmove = e => {\n    if (!this.mobile) return\n    this.moved = true\n  }\n\n  startEditing({x, y}) {\n\n    this.editing = {x, y}\n    const td = this.getCell(x, y)\n    const tdSize = td.getBoundingClientRect()\n    const cellSize = td.firstChild.getBoundingClientRect()\n    Object.assign(td.style, {\n      width: tdSize.width,\n      height: tdSize.height,\n    })\n\n    td.removeChild(td.firstChild)\n    const input = document.createElement('input');\n    input.type = 'text'\n    input.value = this.getVal(x, y)\n\n    Object.assign(input.style, {\n      width: cellSize.width,\n      height: cellSize.height,\n    })\n    td.appendChild(input)\n    input.focus()\n    input.addEventListener('blur', this.stopEditing)\n    input.addEventListener('keydown', this.blurIfEnter)\n  }\n\n  destroyEditing() {\n    if (this.editing) {\n      const {x, y} = this.editing\n      const input = this.getCell(x, y).firstChild\n      input.removeEventListener('blur', this.stopEditing)\n      input.removeEventListener('keydown', this.blurIfEnter)\n    }\n  }\n\n  revertEdit() {\n    if (!this.editing) return\n    const {x, y} = this.editing\n    const td = this.getCell(x, y)\n    const input = td.firstChild\n    input.value = this.getVal(x, y)\n  }\n\n  stopEditing = () => {\n    if (!this.editing) return\n    const {x, y} = this.editing\n    const td = this.getCell(x, y)\n    td.style.width = ''\n    td.style.height = ''\n    const input = td.firstChild\n    input.removeEventListener('blur', this.stopEditing)\n    input.removeEventListener('keydown', this.blurIfEnter)\n    this.setVal(x, y, input.value)\n    td.removeChild(input)\n    this.editing = null\n    this.renderTDContent(td, x, y)\n    this.onDataChanged()\n  }\n  blurIfEnter = e => {\n    const code = e.keyCode\n    if (code === 13) {\n      // enter\n      this.stopEditing()\n      e.preventDefault()\n    }\n  }\n\n  changeSelectedCellsStyle(callback) {\n    const oldS = this.selection\n    callback()\n    this.selection = this.getSelectionCoords()\n    this.forSelectionCoord(oldS, this.restyle)\n    this.forSelectionCoord(this.selection, this.restyle)\n    if (this.options.onSelectionChange) {\n      this.options.onSelectionChange(this.selection)\n    }\n  }\n\n  getSelectionCoords() {\n    if (!this.selectionStart) return {rx: [0, 0], ry: [0, 0]}\n    let rx = [this.selectionStart.x, this.selectionEnd.x]\n    if (rx[0] > rx[1]) rx.reverse()\n    let ry = [this.selectionStart.y, this.selectionEnd.y]\n    if (ry[0] > ry[1]) ry.reverse()\n    return {rx: [rx[0], rx[1] + 1], ry: [ry[0], ry[1] + 1]}\n  }\n\n  forSelectionCoord({rx, ry}, cb) {\n    for (let x = rx[0]; x < rx[1]; x++)\n      for (let y = ry[0]; y < ry[1]; y++)\n        if (this.fitBounds({x, y}))\n          cb({x, y})\n  }\n\n  restyle = ({x, y}) => {\n\n    const status = this.getStatus(x, y)\n    const cell = this.getCell(x, y)\n\n    Object.assign(cell.style, this.TDStyle(x, y, status))\n    Object.assign(cell.firstChild.style, this.contentStyle(x, y, status))\n  }\n  TDStyle(x, y, {selected, onlySelected, editTarget, editing}) {\n\n    return {\n      padding: 0,\n      background: selected && !editing && !onlySelected ? '#d7f2f9' : '',\n      borderStyle: 'solid',\n      borderWidth: '1px',\n      borderColor: editTarget && !editing ? 'black' : (\n        [y ?  this.options.separatorColor: 'transparent', 'transparent', 'transparent',\n          x ? this.options.separatorColor : 'transparent'].join(' ')\n      ),\n      boxSizing: 'border-box',\n      ...cleanStyle(this.options.cellStyle(...arguments))\n    }\n  }\n\n  contentStyle(x, y, {selected, onlySelected, editTarget, editing}) {\n    return {\n      border: 'none',\n      padding: '10px',\n      minWidth: '100px',\n      minHeight: '40px',\n      font: 'inherit',\n      lineHeight: '20px',\n      color: 'inherit',\n      boxSizing: 'border-box',\n      ...cleanStyle(this.options.contentStyle(...arguments))\n    }\n  }\n\n\n  refreshDisplayedValue = ({x, y}) => {\n    const div = this.getCell(x, y).firstChild\n    if (div.tagName === 'DIV') {\n      div.innerText = this.getVal(x, y)\n    }\n    this.restyle({x, y})\n  }\n\n\n  getCoords(e) {\n    // Returns the clicked cell coords or null\n    let node = e.target;\n    while (!node.getAttribute('x') && node.parentElement && node.parentElement !== this.parent) {\n      node = node.parentElement\n    }\n    return {\n      x: parseInt(node.getAttribute('x')) || 0,\n      y: parseInt(node.getAttribute('y')) || 0,\n    }\n  }\n\n\n  replaceDataWithArray(data) {\n\n    data.forEach((line, y) => {\n      line.forEach((val, x) => {\n        this.setVal(x, y, val)\n      })\n    })\n\n    this.onDataChanged()\n  }\n\n  setVal(x, y, val) {\n\n    if (!this.fitBounds({x, y})) return\n\n    this.data.setVal(x, y, val)\n    this.incrementToFit({x: x + 1, y: y + 1})\n    this.refreshDisplayedValue({x, y})\n  }\n\n  getVal(x, y) {\n    return this.data.getVal(x, y)\n  }\n\n  getStatus(x, y) {\n    const {rx, ry} = this.selection\n    const selected = x >= rx[0] && x < rx[1] && y >= ry[0] && y < ry[1]\n    const editTarget = x === rx[0] && y === ry[0] && rx[0] !== rx[1]\n    const editing = this.editing && x === this.editing.x && y === this.editing.y\n    const selectedCount = (rx[1] - rx[0]) * (ry[1] - ry[0])\n    return {selected, editTarget, editing, onlySelected: selected && selectedCount < 2}\n  }\n\n  getCell(x, y) {\n    return this.tbody.children[y].children[x]\n  }\n\n}\n\nclass LooseArray {\n  // An 2D array of strings that only stores non \"\" values\n  data = {}\n\n  setVal(x, y, val) {\n    const hash = this.data\n    const cleanedVal = LooseArray.cleanVal(val)\n    if (cleanedVal) {\n      if (!hash[x]) hash[x] = {}\n      hash[x][y] = cleanedVal\n    } else {\n      // delete item\n      if (hash[x] && hash[x][y]) {\n        delete hash[x][y]\n        if (LooseArray.isEmpty(hash[x]))\n          delete hash[x]\n      }\n    }\n  }\n\n  clear() {\n    this.data = {}\n  }\n\n  getVal(x, y) {\n    const hash = this.data\n    return hash && hash[x] && hash[x][y] || ''\n  }\n\n  static cleanVal(val) {\n    if (val === 0) return '0'\n    if (!val) return ''\n    return val.toString()\n  }\n\n  static isEmpty(obj) {\n    return Object.keys(obj).length === 0\n  }\n\n  toArr() {\n    let width = 1, height = 1;\n    for (let x in this.data) {\n      for (let y in this.data[x]) {\n        height = Math.max(height, parseInt(y) + 1)\n        width = Math.max(width, parseInt(x) + 1)\n      }\n    }\n    const result = [];\n    for (let y = 0; y < height; y++) {\n      result.push([])\n      for (let x = 0; x < width; x++) {\n        result[y].push(this.getVal(x, y))\n      }\n    }\n    return result\n  }\n\n}\n\n\nfunction arrToHTML(arr) {\n  const table = document.createElement('table')\n  arr.forEach(row => {\n    const tr = document.createElement('tr')\n    table.appendChild(tr)\n    row.forEach(cell => {\n      const td = document.createElement('td')\n      tr.appendChild(td)\n      td.innerText = cell\n    })\n  })\n  return table.outerHTML\n}\n\nfunction parsePasteEvent(event) {\n  try {\n\n    const html = (event.clipboardData || window.clipboardData).getData('text/html')\n\n    const iframe = document.createElement('iframe');\n    document.body.appendChild(iframe);\n    iframe.contentWindow.document.open();\n    iframe.contentWindow.document.write(html);\n    iframe.contentWindow.document.close();\n\n    const trs = iframe.contentWindow.document.querySelectorAll('tr')\n    const data = [];\n    Array.prototype.forEach.call(trs, (tr, y) => {\n      const tds = tr.querySelectorAll('td')\n      Array.prototype.forEach.call(tds, (td, x) => {\n        const text = td.innerText;\n        if (!data[y]) data[y] = []\n        data[y][x] = text\n      })\n    })\n\n    document.body.removeChild(iframe);\n    if (data.length) return ensureDimensions(data)\n\n  } catch (e) {\n  }\n\n\n  const fromText = (event.clipboardData || window.clipboardData).getData('text')\n    .split(/\\r\\n|\\n|\\r/).map(row => row.split('\\t'))\n  return ensureDimensions(fromText)\n}\n\nfunction ensureDimensions(rows) {\n  if (!rows || !rows.length || !rows[0].length) return []\n  const width = rows[0].length\n  const height = rows.length\n  const result = []\n  for (var y = 0; y < height; y++) {\n    result.push([])\n    for (var x = 0; x < width; x++) {\n      const val = rows[y][x] || ''\n      result[y].push(val)\n    }\n  }\n  return result\n}\n\nfunction cleanStyle(s) {\n  if (!s) return {}\n  Object.keys(s).forEach(key => !s[key] && s[key] !== 0 && delete s[key]);\n  return s\n}","\nimport Importabular from '../src'\nimport './demo.css'\nnew Importabular({\n  data:[\n    ['Product ID','Product name', 'Price','Unit','Category'],\n    ['256','Sample product', '2.5','Piece','Stuffs'],\n    ['122','Pre mix drink', '5','Bottle','Drinks'],\n  ],\n  node:document.getElementById('editorNode'),\n  maxWidth:5,\n})","var bundleURL = null;\nfunction getBundleURLCached() {\n  if (!bundleURL) {\n    bundleURL = getBundleURL();\n  }\n\n  return bundleURL;\n}\n\nfunction getBundleURL() {\n  // Attempt to find the URL of the current script and use that as the base URL\n  try {\n    throw new Error;\n  } catch (err) {\n    var matches = ('' + err.stack).match(/(https?|file|ftp|chrome-extension|moz-extension):\\/\\/[^)\\n]+/g);\n    if (matches) {\n      return getBaseURL(matches[0]);\n    }\n  }\n\n  return '/';\n}\n\nfunction getBaseURL(url) {\n  return ('' + url).replace(/^((?:https?|file|ftp|chrome-extension|moz-extension):\\/\\/.+)\\/[^/]+$/, '$1') + '/';\n}\n\nexports.getBundleURL = getBundleURLCached;\nexports.getBaseURL = getBaseURL;\n","var bundle = require('./bundle-url');\n\nfunction updateLink(link) {\n  var newLink = link.cloneNode();\n  newLink.onload = function () {\n    link.remove();\n  };\n  newLink.href = link.href.split('?')[0] + '?' + Date.now();\n  link.parentNode.insertBefore(newLink, link.nextSibling);\n}\n\nvar cssTimeout = null;\nfunction reloadCSS() {\n  if (cssTimeout) {\n    return;\n  }\n\n  cssTimeout = setTimeout(function () {\n    var links = document.querySelectorAll('link[rel=\"stylesheet\"]');\n    for (var i = 0; i < links.length; i++) {\n      if (bundle.getBaseURL(links[i].href) === bundle.getBundleURL()) {\n        updateLink(links[i]);\n      }\n    }\n\n    cssTimeout = null;\n  }, 50);\n}\n\nmodule.exports = reloadCSS;\n"]}