{"version":3,"sources":["../dist/index.js","demo.js"],"names":["Importabular","data","t","node","i","onChange","h","minRows","e","maxRows","n","minCols","r","maxCols","o","css","l","width","c","height","a","_LooseArray","R","preventDefault","s","clipboardData","window","getData","document","createElement","body","appendChild","contentWindow","open","write","close","querySelectorAll","Array","prototype","forEach","call","innerText","removeChild","length","split","map","O","rx","ry","x","y","j","U","$","B","v","H","setData","setAttribute","navigator","language","outerHTML","join","copy","P","ctrlKey","key","W","N","q","shiftKey","F","Y","G","J","firstChild","value","mobile","which","tt","Range","setStart","setEnd","cwd","getSelection","removeAllRanges","addRange","tbody","style","userSelect","it","st","nt","ht","Date","now","et","target","moved","removeEventListener","rt","k","keyCode","className","lt","tagName","A","S","console","error","border","background","u","m","Math","ceil","iframe","innerHeight","innerWidth","g","D","toString","innerHTML","Object","assign","table","p","_","I","T","addEventListener","M","parentElement","C","children","L","V","push","K","X","Z","scrollIntoView","behavior","block","getBoundingClientRect","type","focus","ot","reverse","getAttribute","parseInt","ct","keys","max","sheet","getElementById","info","getElementsByClassName","pre","js","trim","replace","lines","offset","match","slice"],"mappings":"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","file":"demo.c971d610.js","sourceRoot":"../demo","sourcesContent":["export default class Importabular{constructor({data:t=[],node:i=null,onChange:h=null,minRows:e=1,maxRows:n=1/0,minCols:r=1,maxCols:o=1/0,css:l=\"\",width:c=\"100%\",height:a=\"80vh\"}){if(!i)return console.error(\"Please call the constructor like this : new Importabular({node: document.body})\");this.t=i,this.i={onChange:h,minRows:e,maxRows:n,minCols:r,maxCols:o,css:s+l},this.h={width:c,height:a,border:\"none\",background:\"transparent\"},this.o(),this.l(t),this.u({x:this.i.minCols-1,y:this.i.minRows-1}),this.m()}t=null;_=1;p=1;g=new _LooseArray;C({x:t,y:s}){return t>=0&&t<this.i.maxCols&&s>=0&&s<this.i.maxRows}m(){const t=Math.ceil(this.iframe.contentWindow.innerHeight/40),s=Math.ceil(this.iframe.contentWindow.innerWidth/100);this.u({x:s-1,y:t-1})}v(){this.i.onChange&&this.i.onChange(this.g.D())}k(t,s,i){const h=document.createElement(\"div\");t.setAttribute(\"x\",s.toString()),t.setAttribute(\"y\",i.toString());const e=this.A(s,i);e?h.innerText=e:h.innerHTML=\"&nbsp;\",t.appendChild(h),this.S({x:s,y:i})}o(){const t=document.createElement(\"iframe\");this.iframe=t,this.t.appendChild(t);const s=t.contentWindow.document;this.cwd=s,s.open(),s.write(`<html lang=\"${navigator.language}\"><body><style>${this.i.css}</style></body></html>`),s.close(),Object.assign(t.style,this.h);const i=document.createElement(\"table\"),h=document.createElement(\"tbody\");i.appendChild(h),s.body.appendChild(i),this.tbody=h,this.table=i;for(let t=0;t<this.p;t++){const s=document.createElement(\"tr\");h.appendChild(s);for(let i=0;i<this._;i++)this.I(s,i,t)}this.T.forEach(t=>s.addEventListener(t,this[t],!0))}T=[\"mousedown\",\"mouseenter\",\"mouseup\",\"mouseleave\",\"touchstart\",\"touchend\",\"touchmove\",\"keydown\",\"paste\",\"cut\",\"copy\"];destroy(){this.M(),this.T.forEach(t=>this.cwd.removeEventListener(t,this[t],!0)),this.iframe.parentElement.removeChild(this.iframe)}I(t,s,i){const h=document.createElement(\"td\");t.appendChild(h),this.k(h,s,i)}V(){if(!this.C({x:0,y:this.p}))return!1;this.p++;const t=this.p-1,s=document.createElement(\"tr\");this.tbody.appendChild(s);for(let i=0;i<this._;i++)this.I(s,i,t);return!0}L(){if(!this.C({x:this._,y:0}))return!1;this._++;const t=this._-1;return Array.prototype.forEach.call(this.tbody.children,(s,i)=>{this.I(s,t,i)}),!0}u({x:t,y:s}){for(;t>this._-1&&this.L(););for(;s>this.p-1&&this.V(););}paste=t=>{if(this.R)return;t.preventDefault();const s=function(t){try{const s=(t.clipboardData||window.clipboardData).getData(\"text/html\"),i=document.createElement(\"iframe\");document.body.appendChild(i),i.contentWindow.document.open(),i.contentWindow.document.write(s),i.contentWindow.document.close();const h=i.contentWindow.document.querySelectorAll(\"tr\"),e=[];if(Array.prototype.forEach.call(h,(t,s)=>{const i=t.querySelectorAll(\"td\");Array.prototype.forEach.call(i,(t,i)=>{const h=t.innerText;e[s]||(e[s]=[]),e[s][i]=h})}),document.body.removeChild(i),e.length)return e}catch(t){}return(t.clipboardData||window.clipboardData).getData(\"text\").split(/\\r\\n|\\n|\\r/).map(t=>t.split(\"\"))}(t),{rx:i,ry:h}=this.O,e={x:i[0],y:h[0]};for(let t=0;t<s.length;t++)for(let i=0;i<s[0].length;i++)this.j(e.x+i,e.y+t,s[t][i]);this.U(()=>{this.$=e,this.B={x:e.x+s[0].length-1,y:e.y+s.length-1}}),this.v()};H(){const{rx:t,ry:s}=this.O;if(t[0]===t[1])return null;const i=t[1]-t[0],h=s[1]-s[0],e=[];for(let n=0;n<h;n++){e.push([]);for(let h=0;h<i;h++)e[n].push(this.A(t[0]+h,s[0]+n))}return e}copy=t=>{if(this.R)return;const s=this.H();s&&(t.preventDefault(),t.clipboardData.setData(\"text/html\",function(t){const s=document.createElement(\"table\");return s.setAttribute(\"lang\",navigator.language),t.forEach(t=>{const i=document.createElement(\"tr\");s.appendChild(i),t.forEach(t=>{const s=document.createElement(\"td\");i.appendChild(s),s.innerText=t})}),`<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0 Transitional//EN\"><html lang=\"${navigator.language}\"><head>\\n<meta http-equiv=\"content-type\" content=\"text/html; charset=utf-8\"/><title></title></head><body>${s.outerHTML}</body></html>`}(s)),t.clipboardData.setData(\"text/plain\",s.map(t=>t.join(\"\")).join(\"\\n\")))};cut=t=>{this.R||(this.copy(t),this.P(\"\"))};keydown=t=>{t.ctrlKey||this.$&&(\"Escape\"===t.key&&this.R&&(t.preventDefault(),this.W(),this.N()),\"Enter\"===t.key&&(t.preventDefault(),this.q(!1,t.shiftKey?-1:1)),\"Tab\"===t.key&&(t.preventDefault(),this.q(!0,t.shiftKey?-1:1)),this.R||(\"Delete\"!==t.key&&\"Backspace\"!==t.key||(t.preventDefault(),this.P(\"\")),\"ArrowDown\"===t.key&&(t.preventDefault(),this.F({y:1},t.shiftKey)),\"ArrowUp\"===t.key&&(t.preventDefault(),this.F({y:-1},t.shiftKey)),\"ArrowLeft\"===t.key&&(t.preventDefault(),this.F({x:-1},t.shiftKey)),\"ArrowRight\"===t.key&&(t.preventDefault(),this.F({x:1},t.shiftKey))),1!==t.key.length||this.R||this.U(()=>{const{x:t,y:s}=this.Y;this.G({x:t,y:s}),this.J(t,s).firstChild.value=\"\"}))};P(t){this.K(this.O,({x:s,y:i})=>this.j(s,i,t)),this.K(this.O,this.X),this.v()}F({x:t=0,y:s=0},i){const h=i?this.B:this.$,e={x:h.x+t,y:h.y+s};this.C(e)&&(this.N(),this.u(e),this.U(()=>{i?this.B=e:this.$=this.B=this.Y=e}),this.Z(e))}q(s,i=1){let{x:h,y:e}=this.Y||{x:0,y:0};const n=this.tt(),{rx:r,ry:o}=n>1?this.O:{rx:[0,this.i.maxCols],ry:[0,this.i.maxRows]};let l;if(s)l=t(h,e,i,r[0],r[1]-1,o[0],o[1]-1);else{const s=t(e,h,i,o[0],o[1]-1,r[0],r[1]-1);l={x:s.y,y:s.x}}this.C(l)&&(this.N(),this.u(l),this.U(()=>{this.Y=l,n<=1&&(this.$=this.B=l)}),this.Z(l))}Z({x:t,y:s}){this.J(t,s).scrollIntoView({behavior:\"smooth\",block:\"nearest\"})}st=!1;$=null;B=null;O={rx:[0,0],ry:[0,0]};R=null;Y=null;mousedown=t=>{if(!this.mobile){if(3===t.which&&!this.R&&this.tt()){let t=new Range;const{rx:s,ry:i}=this.O;return t.setStart(this.J(s[0],i[0]),0),t.setEnd(this.J(s[0],i[0]),1),this.cwd.getSelection().removeAllRanges(),void this.cwd.getSelection().addRange(t)}this.U(()=>{this.tbody.style.userSelect=\"none\",this.B=this.$=this.Y=this.it(t),this.st=!0})}};mouseenter=t=>{this.mobile||this.st&&this.U(()=>{this.B=this.it(t)})};ht=null;et=null;nt(){this.st=!1,this.tbody.style.userSelect=\"\"}mouseup=t=>{this.mobile||3!==t.which&&this.st&&this.U(()=>{this.B=this.it(t),this.nt(),this.ht&&this.ht>Date.now()-300&&this.et.x===this.B.x&&this.et.y===this.B.y&&this.G(this.B),this.ht=Date.now(),this.et=this.B})};mouseleave=t=>{t.target===this.tbody&&this.st&&this.nt()};touchstart=t=>{this.R||(this.mobile=!0,this.moved=!1)};touchend=t=>{this.mobile&&(this.R||this.moved||(this.U(()=>{this.B=this.$=this.Y=this.it(t)}),this.G(this.Y)))};touchmove=t=>{this.mobile&&(this.moved=!0)};G({x:t,y:s}){this.R={x:t,y:s};const i=this.J(t,s),h=i.getBoundingClientRect(),e=i.firstChild.getBoundingClientRect();Object.assign(i.style,{width:h.width-2,height:h.height}),i.removeChild(i.firstChild);const n=document.createElement(\"input\");n.type=\"text\",n.value=this.A(t,s),Object.assign(n.style,{width:e.width,height:e.height}),i.appendChild(n),n.focus(),n.addEventListener(\"blur\",this.N),n.addEventListener(\"keydown\",this.rt)}M(){if(this.R){const{x:t,y:s}=this.R,i=this.J(t,s).firstChild;i.removeEventListener(\"blur\",this.N),i.removeEventListener(\"keydown\",this.rt)}}W(){if(!this.R)return;const{x:t,y:s}=this.R;this.J(t,s).firstChild.value=this.A(t,s)}N=()=>{if(!this.R)return;const{x:t,y:s}=this.R,i=this.J(t,s);i.style.width=\"\",i.style.height=\"\";const h=i.firstChild;h.removeEventListener(\"blur\",this.N),h.removeEventListener(\"keydown\",this.rt),this.j(t,s,h.value),i.removeChild(h),this.R=null,this.k(i,t,s),this.v()};rt=t=>{13===t.keyCode&&(this.N(),t.preventDefault())};U(t){const s=this.O;t(),this.O=this.ot(),this.K(s,this.S),this.K(this.O,this.S)}ot(){if(!this.$)return{rx:[0,0],ry:[0,0]};let t=[this.$.x,this.B.x];t[0]>t[1]&&t.reverse();let s=[this.$.y,this.B.y];return s[0]>s[1]&&s.reverse(),{rx:[t[0],t[1]+1],ry:[s[0],s[1]+1]}}K({rx:t,ry:s},i){for(let h=t[0];h<t[1];h++)for(let t=s[0];t<s[1];t++)this.C({x:h,y:t})&&i({x:h,y:t})}S=({x:t,y:s})=>{this.J(t,s).className=this.lt(t,s)};tt(){const{rx:t,ry:s}=this.O;return(t[1]-t[0])*(s[1]-s[0])}lt(t,s){const{rx:i,ry:h}=this.O;let e=\"\";return t>=i[0]&&t<i[1]&&s>=h[0]&&s<h[1]&&(e+=\" selected\",this.tt()>1&&(e+=\" multi\")),this.Y&&this.Y.x===t&&this.Y.y===s&&(e+=\" focus\"),this.R&&t===this.R.x&&s===this.R.y&&(e+=\" editing\"),e}X=({x:t,y:s})=>{const i=this.J(t,s).firstChild;\"DIV\"===i.tagName&&(i.innerText=this.A(t,s)),this.S({x:t,y:s})};it(t){let s=t.target;for(;!s.getAttribute(\"x\")&&s.parentElement;)s=s.parentElement;return{x:parseInt(s.getAttribute(\"x\"))||0,y:parseInt(s.getAttribute(\"y\"))||0}}setData(t){this.g.ct(),this.l(t);for(let t=0;t<this._;t++)for(let s=0;s<this.p;s++)this.X({x:t,y:s})}getData(){return this.g.D()}l(t){t.forEach((t,s)=>{t.forEach((t,i)=>{this.j(i,s,t)})})}j(t,s,i){this.C({x:t,y:s})&&(this.g.j(t,s,i),this.u({x:t+1,y:s+1}),this.X({x:t,y:s}))}A(t,s){return this.g.A(t,s)}J(t,s){return this.tbody.children[s].children[t]}}class _LooseArray{g={};j(t,s,i){const h=this.g,e=function(t){return 0===t?\"0\":t?t.toString():\"\"}(i);var n;e?(h[t]||(h[t]={}),h[t][s]=e):h[t]&&h[t][s]&&(delete h[t][s],n=h[t],0===Object.keys(n).length&&delete h[t])}ct(){this.g={}}A(t,s){const i=this.g;return i&&i[t]&&i[t][s]||\"\"}D(){let t=1,s=1;for(let i in this.g)for(let h in this.g[i])s=Math.max(s,parseInt(h)+1),t=Math.max(t,parseInt(i)+1);const i=[];for(let h=0;h<s;h++){i.push([]);for(let s=0;s<t;s++)i[h].push(this.A(s,h))}return i}}function t(t,s,i,h,e,n,r){if((t+=i)<h){if(e===1/0)return{x:h,y:s};if(t=e,--s<n){if(r===1/0)return{x:h,y:n};s=r}}return t>e&&(t=h,++s>r&&(s=n,t=h)),{x:t,y:s}}const s=\"\\nhtml{\\n  -ms-overflow-style: none;\\n  scrollbar-width: none;\\n}\\n::-webkit-scrollbar {\\n  visibility: hidden;\\n}\\n*{\\n  box-sizing: border-box;\\n}\\nbody{\\n  padding: 0; \\n  margin: 0;\\n}\\ntable{\\n  border-spacing: 0;\\n  background: white;\\n  border: 1px solid #ddd;\\n  border-width: 0 1px 1px 0;\\n  font-size: 16px;\\n  font-family: sans-serif;\\n  border-collapse: separate;\\n}\\ntd{\\n  padding:0;\\n  border: 1px solid;\\n  border-color: #ddd transparent transparent #ddd; \\n}\\ntd.selected.multi:not(.editing){\\n  background:#d7f2f9;\\n} \\ntd.focus:not(.editing){\\n  border-color: black;\\n} \\ntd>*{\\n  border:none;\\n  padding:10px;\\n  min-width:100px;\\n  min-height: 40px;\\n  font:inherit;\\n  line-height: 20px;\\n  color:inherit;\\n  white-space: normal;\\n}\\ntd>div::selection {\\n    color: none;\\n    background: none;\\n}\\n\";\n","import Importabular from \"../dist/index.js\";\nimport \"./demo.css\";\n\nwindow.sheet = new Importabular({\n  data: [\n    [\"Product ID\", \"Product name\", \"Price\", \"Unit\", \"Category\"],\n    [\"256\", \"Sample product\", \"2.5\", \"Piece\", \"Stuffs\"],\n    [\"122\", \"Pre mix drink\", \"5\", \"Bottle\", \"Drinks\"],\n  ],\n  node: document.getElementById(\"editorNode\"),\n  maxCols: 5,\n});\n\nconsole.info(`\n\nYou can play around with the instance on the page, try :\n\nsheet.getData()\nsheet.setData([['Hello','World']])\nsheet.destroy()\n\n`);\n\nArray.prototype.forEach.call(\n  document.getElementsByClassName(\"readable\"),\n  (n) => {\n    const pre = document.createElement(\"pre\");\n    pre.className = \"auto\";\n\n    let js = n.innerText\n      .trim()\n      .replace('from \"./dist/index.js\"', 'from \"importabular\"')\n      .replace('from \"./src/index.js\"', 'from \"importabular/src/index.js\"');\n\n    const lines = js.split(\"\\n\");\n    const offset = lines[1].match(/ +/)[0].length;\n    js = lines\n      .map((l, i) =>\n        i ? (l.slice(0, offset).trim() ? l.trim() : l.slice(offset)) : l\n      )\n      .join(\"\\n\");\n\n    pre.innerText = js;\n\n    n.parentElement.appendChild(pre);\n  }\n);\n"]}